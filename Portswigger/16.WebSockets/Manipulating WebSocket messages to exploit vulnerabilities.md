# Lab: Manipulating WebSocket messages to exploit vulnerabilities

 This online shop has a live chat feature implemented using WebSockets.

Chat messages that you submit are viewed by a support agent in real time.

To solve the lab, use a WebSocket message to trigger an alert() popup in the support agent's browser. 


# Step 1 Inspect the live chat feature

![image](https://user-images.githubusercontent.com/83407557/213056628-2aa1d865-3a46-4341-b315-16d99ba0dfee.png)

In websocket history I see that this chat is indeed using websockets

![image](https://user-images.githubusercontent.com/83407557/213056988-52df2c5e-2d40-4861-b11e-474eac0f5ffa.png)

Trying to type a payload directly into the chat I see that the websocket encodes it:

![image](https://user-images.githubusercontent.com/83407557/213057255-ee512d26-31df-4f95-9b0c-3edb7dbf5cc3.png)

![image](https://user-images.githubusercontent.com/83407557/213057294-8efaadbd-4893-4409-9d93-a6c0771dd99e.png)

# Step 2 modify a websocket message

I send the string "small text" :

![image](https://user-images.githubusercontent.com/83407557/213057639-6b2b042a-6ddc-488a-8486-10f23880e086.png)

I send that websocket message to repeater and modify it:

![image](https://user-images.githubusercontent.com/83407557/213057868-3cb6bc91-2ce7-42c1-b662-d6ab40948390.png)

And see that the encoding is certainly happening before text goes to a websocket:

![image](https://user-images.githubusercontent.com/83407557/213057947-6663c94b-0066-41c5-bf64-0c1f69a5385c.png)

# Step 3 Send XSS payload

Using repeater again I send an alert(document.domain) script:

![image](https://user-images.githubusercontent.com/83407557/213058121-2f2b9b81-494c-42a6-a293-b4cb6e9281ee.png)


This didn't work so I try an img payload:

![image](https://user-images.githubusercontent.com/83407557/213058594-06524b19-b3f2-41ff-8981-2b7ef74c7997.png)


Which does trigger the alert

![image](https://user-images.githubusercontent.com/83407557/213058663-9034793e-2742-4bae-894a-08260dff0027.png)

and solves the lab:

![image](https://user-images.githubusercontent.com/83407557/213058730-86aa747c-56f8-48f8-8314-edc497b1fcd7.png)



