# Lab: Infinite money logic flaw

 This lab has a logic flaw in its purchasing workflow. To solve the lab, exploit this flaw to buy a "Lightweight l33t leather jacket".

You can log in to your own account using the following credentials: wiener:peter 

# step 1 check functionality

I see that I can enter gift cards, have an email client, and can update my email:

![image](https://user-images.githubusercontent.com/83407557/209450167-c0647733-c976-4fcd-8276-5b032322eb47.png)

I find that I can sign up to the newsletter:

![image](https://user-images.githubusercontent.com/83407557/209450176-ec1af995-e96c-4936-be23-172acedbea2f.png)

![image](https://user-images.githubusercontent.com/83407557/209450197-e5456888-4849-4b34-ac0b-06150304068c.png)

I get a coupon

![image](https://user-images.githubusercontent.com/83407557/209450207-761db1d4-9b18-47b3-826e-9ce12390493f.png)

![image](https://user-images.githubusercontent.com/83407557/209450233-abe5e693-0f4f-4a0f-9bd6-5c05fb79fcd1.png)

# Step 2 buy gift cards with coupon

![image](https://user-images.githubusercontent.com/83407557/209450271-e1a39b3e-c3c5-4f85-bac3-5fffcbbc68ef.png)

I see that the coupon is taking a percentage of the total price:

![image](https://user-images.githubusercontent.com/83407557/209450294-467e7557-e290-44b6-956b-a62181ddabf6.png)

In buying a gift card I get plus a net gain of $3

![image](https://user-images.githubusercontent.com/83407557/209450382-bcd0a680-de25-48ed-accf-2079e7cc6bbc.png)

![image](https://user-images.githubusercontent.com/83407557/209450388-9a0c2882-ca2b-4c86-a3f4-f26927c40a54.png)

![image](https://user-images.githubusercontent.com/83407557/209450392-e2d1565b-1b10-4ff4-b5a7-d6769caa538d.png)

![image](https://user-images.githubusercontent.com/83407557/209450410-35e54584-99c6-4cbb-b8d2-33d43b5ad03a.png)

# Step 3 Create a macro to add $3 over and over

In the settings menu I add a new session handling rule:

![image](https://user-images.githubusercontent.com/83407557/209450555-9dc28988-9da0-4578-90fe-2630413fc302.png)

I call my rul Gift Cards:

![image](https://user-images.githubusercontent.com/83407557/209450565-4e3c1cbd-7634-48a3-806e-146811a6bd9e.png)

I inclue all URLs in scope:

![image](https://user-images.githubusercontent.com/83407557/209450599-f4956348-81ba-46cb-b7c8-9ff1246ac833.png)

I add a run-macro for Rule Actions

![image](https://user-images.githubusercontent.com/83407557/209450624-2011c5cf-f5a4-49a3-a2cf-8ecea8c88bab.png)

I hit add to start recording a macro:

![image](https://user-images.githubusercontent.com/83407557/209450645-92b8a26c-1e29-4e29-a516-cd9e97003fb8.png)

