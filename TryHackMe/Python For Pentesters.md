# Python For Pentesters

|Try Hack Me! Lab Write-up | By: Herman Detwiler | 8/5/21

## Introduction

This lab teaches us to

- Use Python to enumerate the target's subdomain
- Build a simple keylogger
- Scan the network to find target systems
- Scan any target to find the open ports
- Download files from the internet
- Crack hashes


<details>
<summary>Supplied Wordlist</summary>
<br><ul>
123456
password
12345678
1234
12345
dragon
qwerty
696969
mustang
letmein
baseball
master
michael
football
shadow
monkey
abc123
pass
6969
jordan
harley
ranger
iwantu
jennifer
hunter
2000
test
batman
trustno1
thomas
tigger
robert
access
love
buster
1234567
soccer
hockey
killer
george
andrew
charlie
superman
dallas
jessica
pepper
1111
austin
william
daniel
golfer
summer
heather
hammer
yankees
joshua
maggie
enter
ashley
thunder
cowboy
silver
richard
orange
merlin
michelle
corvette
bigdog
cheese
matthew
121212
patrick
martin
freedom
ginger
nicole
sparky
yellow
camaro
secret
falcon
taylor
111111
131313
123123
hello
scooter
please
porsche
guitar
chelsea
black
diamond
nascar
jackson
cameron
654321
computer
amanda
wizard
xxxxxxxx
money
phoenix
mickey
bailey
knight
iceman
tigers
purple
andrea
horny
dakota
aaaaaa
player
sunshine
morgan
starwars
boomer
cowboys
edward
charles
booboo
coffee
xxxxxx
bulldog
ncc1701
rabbit
peanut
john
johnny
gandalf
spanky
winter
brandy
compaq
carlos
tennis
james
mike
brandon
fender
anthony
ferrari
cookie
chicken
maverick
chicago
joseph
diablo
666666
willie
welcome
chris
panther
yamaha
justin
banana
driver
marine
angels
fishing
david
maddog
wilson
dennis
captain
chester
smokey
xavier
steven
viking
snoopy
blue
eagles
winner
samantha
house
miller
flower
jack
firebird
butter
united
turtle
steelers
tiffany
zxcvbn
tomcat
golf
bond007
bear
tiger
doctor
gateway
gators
angel
junior
thx1138
debbie
spider
melissa
booger
1212
flyers
fish
matrix
scooby
jason
walter
boston
braves
yankee
barney
victor
tucker
princess
mercedes
5150
zzzzzz
gunner
bubba
2112
fred
johnson
xxxxx
member
donald
bronco
voyager
rangers
birdie
trouble
white
topgun
green
super
qazwsx
magic
lakers
rachel
slayer
scott
2222
asdf
video
london
7777
marlboro
srinivas
internet
action
carter
jasper
monster
teresa
jeremy
11111111
bill
crystal
peter
rocket
theman
oliver
prince
beach
7777777
muffin
redsox
star
testing
shannon
murphy
frank
hannah
dave
eagle1
11111
mother
nathan
raiders
steve
forever
angela
viper
ou812
jake
gregory
buddy
whatever
young
nicholas
lucky
helpme
jackie
monica
midnight
college
baby
brian
mark
startrek
sierra
leather
232323
4444
beavis
happy
sophie
ladies
naughty
giants
booty
golden
0
fire
sandra
packers
einstein
dolphins
chevy
winston
warrior
sammy
8675309
zxcvbnm
power
victoria
asdfgh
toyota
travis
hotdog
paris
rock
xxxx
redskins
ford
freddy
arsenal
access14
wolf
iloveyou
alex
florida
eric
legend
movie
success
rosebud
jaguar
great
cool
cooper
1313
scorpio
mountain
madison
987654
brazil
lauren
japan
stars
apple
alexis
aaaa
bonnie
jasmine
kevin
matt
qwertyui
danielle
4321
4128
runner
swimming
dolphin
gordon
casper
stupid
saturn
gemini
apples
august
3333
canada
blazer
hunting
kitty
rainbow
112233
arthur
cream
calvin
surfer
samson
kelly
paul
mine
king
racing
5555
eagle
newyork
little
redwings
smith
sticky
cocacola
animal
broncos
private
skippy
marvin
enjoy
apollo
parker
qwert
time
sydney
simon
voodoo
magnum
juice
abgrtyu
777777
dreams
maxwell
music
rush2112
russia
scorpion
rebecca
tester
phantom
billy
6666
albert
index
<ul><br>
</pre>
</details>

## Subdomain Enumeration
  
  ```python
  #!/bin/bash/env python

#Subdomain Enumeration Script for THMs PY4PT2 lab
#Writen by: Herman Detwiler

import requests
import sys

#open and read our wordlist	
subdomain_list = open("wordlist.txt").read()

#Split that content by each line and put it into a variable
subdoms = subdomain_list.splitlines()

#check to see if there is command-line input	
if len(sys.argv) < 2:
    print("Please enter a domain") #if not we tell them this
    sys.exit(1) #and exit our program

#For every sub domain in our split sub domains then trys to make http requests combining our list and input
for sub in subdoms:
	sub_domains = f"http://{sub}.{sys.argv[1]}"
	try:
		requests.get(sub_domains)

	except requests.ConnectionError:
		pass
	else:
		print("Valid Domain", sub_domains) #If it finds one it prints out that it found one and the name of that subdomain.
```                     
                     
                     
                     
